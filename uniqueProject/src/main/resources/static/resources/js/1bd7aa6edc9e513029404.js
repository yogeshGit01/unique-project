webpackJsonp([4],{"./src/app/components/journey/step5/perfios-loader/perfios-loader-modal.component.html":/*!*********************************************************************************************!*\
  !*** ./src/app/components/journey/step5/perfios-loader/perfios-loader-modal.component.html ***!
  \*********************************************************************************************/
function(e,t){e.exports="<div class=modal-header> </div> <div class=modal-body> <p class=no-margin-b> You are now being re-directed to a third party website of Perfios Software Solutions Private Limited. You will access this site solely for the purpose of accessing your income details for the purpose of the Credit Card application processing. </p> </div> <div class=modal-footer> </div>"},"./src/app/components/journey/step5/perfios-loader/perfios-loader-modal.component.js":/*!*******************************************************************************************!*\
  !*** ./src/app/components/journey/step5/perfios-loader/perfios-loader-modal.component.js ***!
  \*******************************************************************************************/
function(e,t,o){!function(){"use strict";var t=o(/*! angular */"./node_modules/angular/index.js"),a=t.module("journey.module").component("perfiosLoader",{template:o(/*! ./perfios-loader-modal.component.html */"./src/app/components/journey/step5/perfios-loader/perfios-loader-modal.component.html"),bindings:{resolve:"<",close:"&",dismiss:"&"}});e.exports=a.name}()},"./src/app/components/journey/step5/skip-modal/skip-modal.component.html":/*!*******************************************************************************!*\
  !*** ./src/app/components/journey/step5/skip-modal/skip-modal.component.html ***!
  \*******************************************************************************/
function(e,t){e.exports='<div class=modal-header> <div class=heading-container> <h4 class=brand-bar></h4> </div> <div class=close-button-container> <span aria-label=Close title=Close class="icon icon-2x icon-delete-small" ng-click=$ctrl.cancel()></span> </div> </div> <div class=modal-body> <p> Statement access through Internet Banking saves you the effort of providing your bank statement/Form 26AS. </p> <p class=no-margin-b> Do you still want to skip this step? </p> </div> <div class=modal-footer> <div class=buttons-container> <button class=button-outline ng-click=$ctrl.Close(false)>No</button> <button class=button-primary ng-click=$ctrl.Close(true)>Yes</button> </div> </div>'},"./src/app/components/journey/step5/skip-modal/skip-modal.component.js":/*!*****************************************************************************!*\
  !*** ./src/app/components/journey/step5/skip-modal/skip-modal.component.js ***!
  \*****************************************************************************/
function(e,t,o){!function(){"use strict";var t=o(/*! angular */"./node_modules/angular/index.js"),a=function(e){var t=this;t.$onInit=function(){},t.Close=function(e){t.close({$value:e})},t.cancel=function(){t.dismiss({$value:"cancel"})}},s=t.module("journey.module").component("skipModal",{template:o(/*! ./skip-modal.component.html */"./src/app/components/journey/step5/skip-modal/skip-modal.component.html"),bindings:{resolve:"<",close:"&",dismiss:"&"},controller:["$scope",a]});e.exports=s.name}()},"./src/app/components/journey/step5/step5.component.html":/*!***************************************************************!*\
  !*** ./src/app/components/journey/step5/step5.component.html ***!
  \***************************************************************/
function(e,t){e.exports='<div class=row> <form id=step5 name=step5Form autocomplete=off novalidate> <div class="col-md-12 col-sm-12 col-xs-12" ui-view=step5View> <input type=text class=hidden-field ng-model=$ctrl.robocheck tabindex=-1> <alert-msg ng-if=$ctrl.errMsg type=ERROR> {{$ctrl.errMsg}} </alert-msg> <alert-msg ng-if=$ctrl.showTrbMessage type=SUCCESS close=$ctrl.closeSuccessMsg()> {{$ctrl.trbApiResponseMsg}} </alert-msg> <h1 class="brand-bar no-margin-top">Employment details</h1> <div class=row> <div class="col-md-4 col-sm-6 col-xs-12"> <div class="form-group line-spacer-xs"> <label id=empStatusLbl for=employmentStatus>Employment status</label> <div ng-class="{\'has-error\': step5Form.employmentStatus.$invalid && (step5Form.employmentStatus.$touched || $ctrl.submitted)}"> <custom-select ng-if="$ctrl.selectedCard.key !=\'HPR\' && $ctrl.selectedCard.key !=\'SVC\'"> <select id=employmentStatus name=employmentStatus class=form-control ng-model=$ctrl.model.employmentStatus ng-options="item for item in $ctrl.employmentStatus" aria-describedby=empStatusErrMsg aria-invalid="{{step5Form.employmentStatus.$invalid && (step5Form.employmentStatus.$touched || $ctrl.submitted)}}" ng-disabled="$ctrl.cardTypeAE != \'Supplementary Card\'" required> <option value="" disabled=disabled>Please select</option> <option value=$ctrl.model.employmentStatus[0]></option> </select> </custom-select> <custom-select ng-if="$ctrl.selectedCard.key==\'HPR\' || $ctrl.selectedCard.key==\'SVC\'"> <select id=employmentStatus name=employmentStatus class=form-control ng-model=$ctrl.model.employmentStatus ng-options="item for item in $ctrl.employmentStatus" aria-describedby=empStatusErrMsg aria-invalid="{{step5Form.employmentStatus.$invalid && (step5Form.employmentStatus.$touched || $ctrl.submitted)}}" ng-disabled="" required> <option value="" disabled=disabled>Please select</option> <option value=$ctrl.model.employmentStatus[0]></option> </select> </custom-select> </div> <div id=empStatusErrMsg ng-class="{\'has-error\': step5Form.employmentStatus.$invalid && (step5Form.employmentStatus.$touched || $ctrl.submitted)}"> <validation-msg ng-if="step5Form.employmentStatus.$error.required && (step5Form.employmentStatus.$touched || $ctrl.submitted)"> {{$ctrl.errorMessages.enterEmploymentStatus}} </validation-msg> </div> </div> </div> <div class="col-md-4 col-sm-6 col-xs-12" ng-if="$ctrl.selectedCard.key==\'HPR\'"> <div class="form-group line-spacer-xs"> <label for=appCriteria>Application Criteria</label> <div ng-class="{\'has-error\': step5Form.appCriteria.$invalid && (step5Form.appCriteria.$touched || $ctrl.submitted)}"> <custom-select> <select id=appCriteria name=appCriteria class=form-control ng-model=$ctrl.model.appCriteria ng-options="item for item in $ctrl.appCriteriaOpt" aria-describedby=appCriteriaErrMsg ng-change=$ctrl.getDataFromBackend() aria-invalid="{{step5Form.appCriteria.$invalid && (step5Form.appCriteria.$touched || $ctrl.submitted)}}" required> <option value="">Please select</option> </select> </custom-select> </div> <div id=appCriteriaErrMsg ng-class="{\'has-error\': step5Form.appCriteria.$invalid}"> <validation-msg ng-if="step5Form.appCriteria.$error.required && (step5Form.appCriteria.$touched || $ctrl.submitted)"> Please select your application criteria using the drop-down menu to continue with your application. </validation-msg> </div> </div> </div> </div> <div class=row ng-if="$ctrl.model.employmentStatus == \'Student\' && $ctrl.selectedCard.key==\'HPR\'"> <div class="col-md-4 col-sm-6 col-xs-12"> <div class="form-group line-spacer"> <label for=startDate>Course Start Date</label> <div ng-class="{\'has-error\': step5Form.startDate.$invalid && ($ctrl.submitted || step5Form.startDate.$touched)}"> <input type=date id=startDate name=startDate ng-minlength=0 maxlength=100 class=form-control ng-model=$ctrl.model.startDate aria-describedby=startDateErrMsg aria-invalid="{{step5Form.startDate.$invalid && (step5Form.startDate.$touched || $ctrl.submitted)}}" required> </div> </div> <div id=startDateErrMsg ng-class="{\'has-error\': step5Form.startDate.$invalid}"> <validation-msg ng-if="step5Form.startDate.$error.required && (step5Form.startDate.$touched || $ctrl.submitted)"> Please enter your Course Start Date using the calendar icon to continue with your application. </validation-msg> </div> </div> <div class="col-md-4 col-sm-6 col-xs-12"> <div class="form-group line-spacer"> <label for=endDate>Course End Date</label> <div ng-class="{\'has-error\': step5Form.endDate.$invalid && ($ctrl.submitted || step5Form.endDate.$touched)}"> <input type=date id=endDate name=endDate ng-minlength=0 maxlength=100 class=form-control ng-model=$ctrl.model.endDate aria-describedby=endDateErrMsg aria-invalid="{{step5Form.endDate.$invalid && (step5Form.endDate.$touched || $ctrl.submitted)}}" required> </div> </div> <div id=endDateErrMsg ng-class="{\'has-error\': step5Form.endDate.$invalid}"> <validation-msg ng-if="step5Form.endDate.$error.required && (step5Form.endDate.$touched || $ctrl.submitted)"> Please enter your Course End Date using the calendar icon to continue with your application. </validation-msg> </div> </div> </div> <div class=row ng-if="$ctrl.model.appCriteria === \'TRB\' &&  $ctrl.showTrbData"> <div class="col-md-4 col-sm-6 col-xs-12"> <div class="form-group line-spacer"> <label for=trbBalanceValue>Total Assets (TRB)</label> <div ng-class="{\'has-error\': step5Form.trbBalanceValue.$invalid && ($ctrl.submitted || step5Form.trbBalanceValue.$touched)}"> <input type=tel id=trbBalanceValue name=trbBalanceValue ng-minlength=0 maxlength=100 class=form-control ng-model=$ctrl.model.trbBalanceValue ng-disabled=true> </div> </div> </div> <div class="col-md-4 col-sm-6 col-xs-12"> <div class="form-group line-spacer"> <label for=limitAssignedValue>Total HSBC Exposure (Limit Assigned)</label> <div ng-class="{\'has-error\': step5Form.limitAssignedValue.$invalid && ($ctrl.submitted || step5Form.limitAssignedValue.$touched)}"> <input type=tel id=limitAssignedValue name=limitAssignedValue ng-minlength=0 maxlength=100 class=form-control ng-model=$ctrl.model.limitAssignedValue ng-disabled=true> </div> </div> </div> </div> </div> <step-footer show-back=true back-callback=$ctrl.goback() show-proceed=false show-continue="$ctrl.isStaffJourney || !$ctrl.isStaffJourney" continue-callback=$ctrl.next(step5Form) proceed-callback=$ctrl.next(step5Form.$valid) skip-callback=$ctrl.skip(step5Form.$valid) skip-overlay=true> </step-footer> </form> </div> <form ng-form-commit ng-show=false name=autoform method=post action="{{$ctrl.perfiosUrl | trustedUrl}}"> <input ng-model=$ctrl.formPayload name=payload> <input ng-model=$ctrl.formSignature name=signature> <button type=button ng-click=save(autoform)>buy</button> </form>'},"./src/app/components/journey/step5/step5.component.js":/*!*************************************************************!*\
  !*** ./src/app/components/journey/step5/step5.component.js ***!
  \*************************************************************/
function(e,t,o){!function(){"use strict";function t(e,t,o,a,r,n,i,l,c,p){var d=this;d.$onInit=function(){e.showSelectedCard=!0,e.showARN=!1,e.stepsHeader.currentStep=2,d.perfiosUrl=s.PERFIOS_URL,d.isStaffJourney=l.isStaffJourney(),d.selectedCard=l.getSelectedCard();var t=p.getContactDetails();d.isStaffJourney?d.cardTypeAE=t.cardType:d.cardTypeAE="Primary Card",d.employmentStatus=["Employed (salaried)","Housewife","Retired","Student","Self-Employed","Unemployed"],d.appCriteriaOpt=["TRB"],d.model={},m(),l.getErrorMessages().then(function(e){d.errorMessages=e.step5}),d.isStaffJourney=l.isStaffJourney(),n.pageList.employmentDetails.internal_reference_id=l.getDataFromStorageContact().adobeId,n.trackPageLoad(n.pageList.employmentDetails),o()};var m=function(){d.model=a.getUserDetails(),d.model.employmentStatus=d.employmentStatus[0],"SVC"==d.selectedCard.key&&(d.employmentStatus=["Employed (salaried)","Self-Employed"]),console.log("Selected value from frontend common ======== "+d.employmentStatus)};d.skip=function(e){r.open({component:"skipModal"}).result.then(function(o){if(o)if(e){var s={employmentStatus:d.model.employmentStatus,hasSkippedPerfios:d.model.perfiosCheck?"N":"Y"},r={robocheck:d.robocheck?d.robocheck:""};a.sendEmploymentDetails(s,r,"Y").then(function(e){e.success?t.go("app.journey.s6-incomeDetails",{cardKey:d.selectedCard.key}):10006===e.errorCode&&t.go("app.journey.s1-cards")})}else d.submitted=!0},function(){}),n.buttonList.buttonClick.event_content="skip and upload income documents",n.trackUserAction(n.buttonList.buttonClick)},d.goback=function(){t.go("app.journey.s3-personalDetails",{cardKey:d.selectedCard.key}),n.buttonList.buttonClick.event_content="back",n.trackUserAction(n.buttonList.buttonClick)},d.next=function(e){if("HPR"==d.selectedCard.key)u(e);else if(null!==d.model.employmentStatus){var o={employmentStatus:d.model.employmentStatus,hasSkippedPerfios:d.model.perfiosCheck?"N":"Y"},s={robocheck:d.robocheck?d.robocheck:""};a.sendEmploymentDetails(o,s,o.hasSkippedPerfios).then(function(e){e.success?t.go("app.journey.s6-incomeDetails",{cardKey:d.selectedCard.key}):10006===e.errorCode&&t.go("app.journey.s1-cards")}),n.buttonList.buttonClick.event_content="proceed",n.trackUserAction(n.buttonList.buttonClick)}else d.submitted=!0,c.focusOnInvalid("step5Form")};var u=function(e){if(e.$valid){if(!d.showTrbData)return void console.log(" trb is empty");var o={employmentStatus:d.model.employmentStatus,hasSkippedPerfios:d.model.perfiosCheck?"N":"Y",applicationCriteria:d.model.appCriteria,courseStartDate:null==document.getElementById("startDate")?null:document.getElementById("startDate").value,courseEndDate:null==document.getElementById("endDate")?null:document.getElementById("endDate").value},s={robocheck:d.robocheck?d.robocheck:""};a.sendEmploymentDetails(o,s,o.hasSkippedPerfios).then(function(e){e.success?t.go("app.journey.s6-incomeDetails",{cardKey:d.selectedCard.key}):10006===e.errorCode?t.go("app.journey.s1-cards"):e.errorCode&&(d.errMsg=e.message)}),n.buttonList.buttonClick.event_content="proceed",n.trackUserAction(n.buttonList.buttonClick)}else c.focusOnInvalid("step5Form")};d.getDataFromBackend=function(){if(d.errMsg="",d.showTrbMessage="","TRB"==d.model.appCriteria&&"HPR"==d.selectedCard.key){console.log("Hi for trb for "+d.model.appCriteria);var e={robocheck:d.robocheck?d.robocheck:""},t={appCriteriaFrontend:d.model.appCriteria};a.getTRBDataFromIbps(t,e).then(function(e){e.success?(d.showTrbData=!0,d.model.trbBalanceValue=e.trbBalanceAmount,d.model.limitAssignedValue=e.limitAssigned,d.showTrbMessage=!0,d.trbApiResponseMsg=e.responseMessage):(d.showTrbData=!1,d.errMsg=e.responseMessage)})}else console.log("No for trb for "+d.model.appCriteria)},d.continue=function(e){e?t.go("app.journey.s6-incomeDetails",{cardKey:d.selectedCard.key}):d.submitted=!0},d.saveAndNavToPerfios=function(e){if(e){var t={robocheck:d.robocheck?d.robocheck:""};a.getPerfiosReport(t).then(function(e){if(e){var o={employmentStatus:d.model.employmentStatus,hasSkippedPerfios:"Y"};a.sendEmploymentDetails(o,t,"N").then(function(t){if(t.success){r.open({component:"perfiosLoader",backdrop:"static",size:"md"});l.setDisableBrowserClose(!0),d.model.perfiosCheck=!0,d.formPayload=e.payload,d.formSignature=e.signature,i(function(){document.forms.autoform.submit()},2e3)}})}}),n.buttonList.buttonClick.event_content="continue",n.trackUserAction(n.buttonList.buttonClick)}else d.submitted=!0}}var a=o(/*! angular */"./node_modules/angular/index.js"),s=o(/*! config */"./src/resources/config/env.prod.json");o(/*! ./step5.service */"./src/app/components/journey/step5/step5.service.js"),o(/*! ./step5.component.scss */"./src/app/components/journey/step5/step5.component.scss"),o(/*! ./skip-modal/skip-modal.component */"./src/app/components/journey/step5/skip-modal/skip-modal.component.js"),o(/*! ./perfios-loader/perfios-loader-modal.component */"./src/app/components/journey/step5/perfios-loader/perfios-loader-modal.component.js");var r=a.module("journey.module").component("step5",{template:o(/*! ./step5.component.html */"./src/app/components/journey/step5/step5.component.html"),controller:["$rootScope","$state","$anchorScroll","step5Service","$uibModal","analyticService","$timeout","journeyService","UtilService","appState",t]});e.exports=r.name}()},"./src/app/components/journey/step5/step5.component.scss":/*!***************************************************************!*\
  !*** ./src/app/components/journey/step5/step5.component.scss ***!
  \***************************************************************/
function(e,t){},"./src/app/components/journey/step5/step5.service.js":/*!***********************************************************!*\
  !*** ./src/app/components/journey/step5/step5.service.js ***!
  \***********************************************************/
function(e,t){!function(){"use strict";var t=angular.module("journey.module").service("step5Service",["$rootScope","$http","$q","appState","CONFIG",function(e,t,o,a,s){var r=this;r.setDataInStorage=function(e){var t={primaryApplicant:e};a.mergeApplicationData(t)};var n=function(e){var t=a.getApplicationData();return t.primaryApplicant&&t.primaryApplicant[e]?t.primaryApplicant[e]:null};r.sendEmploymentDetails=function(o,i,l){var c,p;return e.integrationsActive?(p="POST",c=s.apiUrl+"/applicantdetails/employmentdetails/perfios/save/"+n("arn")+"?hash_id="+Math.random()):(p="GET",c="resources/data/mock/step5_employment-details/employment_details_perfios_save.json"),t({method:p,url:c,headers:{"Content-Type":"application/json"},data:JSON.stringify(o),params:i}).then(function(e){if(200===e.status&&e.data){a.setEmployerName(e.data.employerName);var t=n("employmentStatus"),s=n("hasSkippedPerfios");return t===o.employmentStatus&&s===l||r.setDataInStorage({employmentDetails:null}),r.setDataInStorage(o),e.data}e&&e.validationErrors},function(e){})},r.getUserDetails=function(){var e={},t=a.getApplicationData();return t&&t.primaryApplicant&&(e.selectedEmploymentStatus=t.primaryApplicant.employmentStatus?t.primaryApplicant.employmentStatus:null,e.perfiosCheck=t.primaryApplicant.hasSkippedPerfios?t.primaryApplicant.hasSkippedPerfios:"Y",e.perfiosCheck="Y"!==e.perfiosCheck),e},r.getPerfiosReport=function(o){var a,r;e.integrationsActive?(r="POST",a=s.apiUrl+"/perfiosAPI/generatePerfiosReport/"+n("arn")):(r="GET",a="resources/data/mock/step5_employment-details/perfios_report.json");var i={dob:n("dateOfBirth"),email:n("email")};return t({method:r,url:a,headers:{"Content-Type":"application/json"},data:JSON.stringify(i),params:o}).then(function(e){return e.data})},r.getPerfiosStatus=function(){var a,c=o.defer();return a=e.integrationsActive?s.apiUrl+"/perfiosAPI/statusCheckTxn/"+n("arn")+"?hash_id="+Math.random():"resources/data/mock/step5_employment-details/perfios_status.json",t({method:"GET",url:a,headers:{"Content-Type":"application/json"}}).then(function(e){var t={status:"OK"};if(e&&200===e.status&&e.data&&e.data.success)if(r.setDataInStorage({hasSkippedPerfios:"N"}),8001===e.data.errorCode)t.status="DELETED",c.resolve(t);else{var o=e.data.message;l(o).then(function(e){"PAN_MISMATCH"!==e.panStatusFlag?(i(e),t.panStatus=!0,c.resolve(t)):(t.panStatus=!1,c.resolve(t))})}else r.setDataInStorage({hasSkippedPerfios:"Y"}),t.status="FAILURE",c.resolve(t)},function(e){c.reject("Some error occured!")}),c.promise};var i=function(e){var t={panStatusFlag:e.panStatusFlag,employmentDetails:{companyName:e.companyName,perfiosCompanyName:e.companyName,annualIncome:e.grossAnnualIncome,isUnhapppyJourney:e.isUnhapppyJourney}};r.setDataInStorage(t)},l=function(a){var r,i,l=o.defer();return e.integrationsActive?(i="POST",r=s.apiUrl+"/applicantdetails/getincomedetails/"+n("arn")+"?hash_id="+Math.random()):(i="GET",r="resources/data/mock/step5_employment-details/perfios_income_data.json"),t({method:i,url:r,headers:{"Content-Type":"application/json"}}).then(function(e){e&&200===e.status&&e.data?l.resolve(e.data):l.resolve({panStatusFlag:"FAILED"})}),l.promise};r.getTRBDataFromIbps=function(o,a){var r,i;return e.integrationsActive?(i="POST",r=s.apiUrl+"/applicantdetails/employmentdetails/getTrbData/"+n("arn")+"?hash_id="+Math.random()):(i="GET",r="resources/data/mock/step5_employment-details/getTrbDataFromIbps.json"),t({method:i,url:r,headers:{"Content-Type":"application/json"},data:o,params:a}).then(function(e){if(e&&200===e.status&&e.data)return e.data})}}]);e.exports=t.name}()}});
//# sourceMappingURL=1bd7aa6edc9e513029404.js.map