webpackJsonp([17],{"./src/app/components/journey/signature-consent/signature-consent.component.html":/*!***************************************************************************************!*\
  !*** ./src/app/components/journey/signature-consent/signature-consent.component.html ***!
  \***************************************************************************************/
function(e,r){e.exports='<div ng-hide=$ctrl.showLoader class=row> <div class="col-md-12 col-sm-12 col-xs-12"> <form name=step12Form focus-on-error novalidate ng-hide=$ctrl.showLoader> <input type=text class=hidden-field ng-model=$ctrl.robocheck tabindex=-1> <div class=row> <div class="col-md-12 col-sm-12 col-xs-12"> <h1 class="brand-bar no-margin-top"> Marketing Offers </h1> <alert-msg ng-if="$ctrl.eSignError && !$ctrl.isStaffJourney" type=ERROR> Sorry! There seems to be a technical problem. Request you to save your application and retry at a later time to complete your Credit Card application. </alert-msg> <alert-msg ng-if="$ctrl.eSignError && $ctrl.isStaffJourney" type=ERROR> Sorry! There seems to be a technical problem. Your HSBC representative will inform you of the next steps to complete the application. </alert-msg> <alert-msg ng-if=$ctrl.errMsg type=ERROR> {{$ctrl.errMsg}} </alert-msg> </div> </div> <div class=row> <div class="col-md-12 col-sm-12 col-xs-12"> <p class=para> From time to time, HSBC communicates various features/products/promotional offers which offer significant benefits to its customers and may use the service of third party agencies to do so. </p> <div> <input type=checkbox id=consentChk name=consentChk class=screen-reader-only ng-model=$ctrl.model.informationConsent ng-change=$ctrl.toggleConsent() ng-focus="$ctrl.chkFocus = true;" ng-blur="$ctrl.chkFocus = false;"> <label for=consentChk class=checkbox-label ng-class="{\'focus\': $ctrl.chkFocus}"> I authorise HSBC to use information or data relating to me, for communicating marketing offers as outlined above. </label> </div> </div> </div> <step-footer show-back=true back-callback=$ctrl.goback() show-save=true save-callback=$ctrl.save() show-continue=true continue-button-id=continue-btn continue-disabled=false continue-callback=$ctrl.next()> </step-footer> </form> </div> </div> <loading ng-show=$ctrl.showLoader></loading>'},"./src/app/components/journey/signature-consent/signature-consent.component.js":/*!*************************************************************************************!*\
  !*** ./src/app/components/journey/signature-consent/signature-consent.component.js ***!
  \*************************************************************************************/
function(e,r,t){!function(){"use strict";var r=t(/*! angular */"./node_modules/angular/index.js");t(/*! ./signature-consent.component.scss */"./src/app/components/journey/signature-consent/signature-consent.component.scss"),t(/*! ./signature-consent.component.service.js */"./src/app/components/journey/signature-consent/signature-consent.component.service.js");var n=r.module("journey.module").component("signatureConsent",{template:t(/*! ./signature-consent.component.html */"./src/app/components/journey/signature-consent/signature-consent.component.html"),controller:["$rootScope","$anchorScroll","$state","$uibModal","$timeout","journeyService","signatureConsentService","analyticService","UtilService",function(e,t,n,o,a,s,c,i,l){var p=this;p.showLoader=!1,p.$onInit=function(){e.$broadcast("hide-step-header",{hideHeader:!1}),e.showSelectedCard=!0,e.showARN=!0,t(),e.stepsHeader.currentStep=5,p.model={},p.model=r.merge({},c.getUserDetails()),p.isStaffJourney=s.isStaffJourney(),p.selectedCard=s.getSelectedCard(),e.dipARN=s.getDataFromStorage().primaryApplicant.dipDetails.dipArn,p.refNumber=s.getDataFromStorage().primaryApplicant.dipDetails.dipArn,a(function(){u()},1e3),i.pageList.signature.internal_reference_id=s.getDataFromStorageContact().adobeId,i.trackPageLoad(i.pageList.signature)};var u=function(){c.getESignStatus().then(function(e){e.success?s.isStaffJourney()||n.go("app.complete-ack",{saveData:{statusCode:e.errorCode},cardKey:p.selectedCard.key}):9002===e.errorCode&&(p.eSignError=!0,i.buttonList.error.event_content="E-Sign failure",i.trackUserAction(i.buttonList.error))})};p.toggleConsent=function(){i.buttonList.toggleClick.event_content="Enabled",i.trackUserAction(i.buttonList.toggleClick)},p.goback=function(){c.incomeDoc?n.go("app.journey.document",{cardKey:p.selectedCard.key}):c.supplementaryCardApplied?n.go("app.journey.supplementary",{cardKey:p.selectedCard.key}):c.balanceTransferTaken?n.go("app.journey.balance-transfer",{cardKey:p.selectedCard.key}):n.go("app.journey.card-DIP",{cardKey:p.selectedCard.key}),i.buttonList.buttonClick.event_content="back",i.trackUserAction(i.buttonList.buttonClick)},p.next=function(){p.showLoader=!0,e.$broadcast("trigger-verification-loader",{showLoader:!0,showCard:!1,loaderType:"PERFIOS"}),p.eSignError=!1;var r={robocheck:p.robocheck?p.robocheck:""},t={informationConsent:p.model.informationConsent?"Y":"N",reqCounter:1};c.sendSignatureData(t,r).then(function(e){console.log("Response code ===",e),e.success||(p.showLoader=!1),e.success?s.isStaffJourney()?(console.log("reahed inside success code sending ahead ===",e),n.go("app.complete-ack",{saveData:{statusCode:e.errorCode,autoUrl:e.signingUrl},cardKey:p.selectedCard.key})):l.isEmpty(e.signingUrl)?alert("There is some error while generating videokyc url"):(c.setDataInStorage({consents:t}),n.go("app.complete-ack",{saveData:{statusCode:e.errorCode,autoUrl:e.signingUrl},cardKey:p.selectedCard.key})):3==e.errorCode||4==e.errorCode?n.go("app.journey.s1-cards"):10009===e.errorCode?p.errMsg="VIDEO_KYC_FAILED":119900===e.errorCode?p.errMsg="PERFIOS_NOT_DONE":404===e.errorCode&&(p.errMsg=e.message)}),i.buttonList.buttonClick.event_content="continue",i.trackUserAction(i.buttonList.buttonClick)},p.save=function(){o.open({backdrop:"static",keyboard:!1,modalFade:!0,component:"overlaySaveConfirmation",windowClass:"card-detail-modal center-modal"}).result.then(function(r){if(r){var t={robocheck:p.robocheck?p.robocheck:""};c.save(t).then(function(r){r.success?n.go("app.save-exit",{cardKey:p.selectedCard.key}):3==r.errorCode?n.go("app.journey.s1-cards"):4==r.errorCode&&(e.sessionError=!0,n.go("app.app-retrieval"))})}},function(){}),i.buttonList.buttonClick.event_content="save for later",i.trackUserAction(i.buttonList.buttonClick)}}]});e.exports=n.name}()},"./src/app/components/journey/signature-consent/signature-consent.component.scss":/*!***************************************************************************************!*\
  !*** ./src/app/components/journey/signature-consent/signature-consent.component.scss ***!
  \***************************************************************************************/
function(e,r){},"./src/app/components/journey/signature-consent/signature-consent.component.service.js":/*!*********************************************************************************************!*\
  !*** ./src/app/components/journey/signature-consent/signature-consent.component.service.js ***!
  \*********************************************************************************************/
function(e,r){!function(){"use strict";var r=angular.module("journey.module").service("signatureConsentService",["$rootScope","$http","$q","$timeout","$interval","appState","CONFIG",function(e,r,t,n,o,a,s){var c=this;c.arn=null,c.balanceTransferTaken=null,c.setDataInStorage=function(e){var r=angular.merge({},a.getApplicationData(),{primaryApplicant:e});a.setApplicationData(r)},c.getDataFromStorage=function(){return a.getApplicationData()},c.sendSignatureData=function(e,r){console.log("very first log in service");var a={};a.active=!0,a.pollTimeout=3500,a.pollInterval=3500,a.pollCount=6;var s=t.defer();i(r,s,a,e);var c=0;return n(function(){console.log("I am running after "+a.pollTimeout+" Millisecs delay");var t=o(function(){if(c++,console.log("inside intervalPromise",c),console.log(" counter value at start of interval is ==",e.reqCounter),a.active&&c<=3?(console.log("retryDip.active  true===",a.active+" And value of counter =",e.reqCounter),i(r,s,a,e)):console.log("retryDip.active  false===",a.active+" And value of counter =",e.reqCounter),console.log(" counter value here is ==",e.reqCounter),a.active&&e.reqCounter>4){console.log("Specific condition met, resolving defer and cancelling interval");var n={errorCode:119900,success:!1};s.resolve(n),o.cancel(t)}},a.pollInterval,a.pollCount)},a.pollTimeout),console.log("yes reached here=="),s.promise};var i=function(t,o,a,l){console.log("reData sending to backend==",JSON.stringify(l));var p,u;return e.integrationsActive?(u="POST",p=s.apiUrl+"/adobe/esign/initiate/"+c.arn+"?hash_id="+Math.random()):(u="GET",p="resources/data/mock/step12_e-sign/e-sign_initiate.json"),r({method:u,url:p,headers:{"Content-Type":"application/json"},params:t,data:JSON.stringify(l)}).then(function(e){if(l.reqCounter++,console.log(" for counter ",l.reqCounter+" response from backend  for pol count  has value==",e.data),200!==e.status||!e.data)return console.log("else of 200",e),o.reject("Some error has occured"),{success:!1,message:"Sorry! Some internal error has occured"};100===e.data.errorCode?a.active=!0:101===e.data.errorCode?(console.log("101 response current value of counter==",l.reqCounter),a.active=!1,l.reqCounter=4,n(function(){console.log("101 response after making it 4==",l.reqCounter),i(t,o,a,l)},1e3)):(a.active=!1,o.resolve(e.data))},function(e){return console.log("last 1",e),{success:!1,message:"Sorry! Some internal error has occured",errorCode:404}},function(e){console.log("last 2",e)})};c.save=function(t){var n,o;return e.integrationsActive?(o="POST",n=s.apiUrl+"/applicantdetails/esignconsent/save/"+c.arn+"/"+!0+"?hash_id="+Math.random()):(o="GET",n="resources/data/mock/step12_e-sign/e-sign_save.json"),r({method:o,url:n,headers:{"Content-Type":"application/json"},params:t}).then(function(e){return 200===e.status&&e.data?e.data:{success:!1,message:"Sorry! Some internal error has occured"}},function(e){return{success:!1,message:"Sorry! Some internal error has occured"}})},c.getESignStatus=function(){var t,n,o={robocheck:""};return e.integrationsActive?(n="POST",t=s.apiUrl+"/adobe/esign/status/"+c.arn+"?hash_id="+Math.random()):(n="GET",t="resources/data/mock/step12_e-sign/e-sign_status.json"),r({method:n,url:t,headers:{"Content-Type":"application/json"},params:o}).then(function(e){return 200===e.status&&e.data?e.data:{success:!1,message:"Sorry! Some internal error has occured"}},function(e){return{success:!1,message:"Sorry! Some internal error has occured"}})},c.getUserDetails=function(){var e={},r=a.getApplicationData();if(r&&r.primaryApplicant){if(c.arn=r.primaryApplicant.arn,r.primaryApplicant.consents=r.primaryApplicant.consents||{},e.informationConsent="Y"==r.primaryApplicant.consents.informationConsent,r.primaryApplicant.employmentDetails){var t=r.primaryApplicant.employmentDetails.changedCompanyName?r.primaryApplicant.employmentDetails.changedCompanyName:"N",n=r.primaryApplicant.hasSkippedPerfios?r.primaryApplicant.hasSkippedPerfios:"N",o=r.primaryApplicant.panStatusFlag?r.primaryApplicant.panStatusFlag:"N";c.incomeDoc="Y"==t||"Y"==n||"NO_PAN_FOUND"==o}r.primaryApplicant.dipDetails&&(c.balanceTransferTaken=r.primaryApplicant.dipDetails.balanceTransferTaken?r.primaryApplicant.dipDetails.balanceTransferTaken:"N","N"==c.balanceTransferTaken?c.balanceTransferTaken=!1:c.balanceTransferTaken=!0,c.supplementaryCardApplied=r.primaryApplicant.dipDetails.supplementaryCardApplied?r.primaryApplicant.dipDetails.supplementaryCardApplied:null,"N"==c.supplementaryCardApplied?c.supplementaryCardApplied=!1:c.supplementaryCardApplied=!0)}return e}}]);e.exports=r.name}()}});
//# sourceMappingURL=70ce261303a581a922e317.js.map